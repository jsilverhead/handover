{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport server from '../../../utilites/connection';\nconst logURI = '/auth/login';\nconst regURI = '/auth/registration';\nconst initialState = {\n  newUser: {\n    userName: '',\n    email: '',\n    phone: '',\n    password: '',\n    token: null,\n    isLoading: false,\n    status: null\n  },\n  userLogin: {\n    user: null,\n    token: null,\n    isLoading: false,\n    status: null\n  }\n};\nexport const LoginAttempt = createAsyncThunk('auth/LoginAttempt', async _ref => {\n  let {\n    email,\n    password\n  } = _ref;\n  try {\n    const res = await server.get(logURI, {\n      email,\n      password\n    });\n    if (res.data.token) {\n      window.localStorage.setItem('token', res.data.token);\n    }\n    return res.data;\n  } catch (e) {\n    console.log(`Login failed: ${e}`);\n  }\n});\nexport const createUser = createAsyncThunk('auth/createUser', async _ref2 => {\n  let {\n    userName,\n    email,\n    phone,\n    password\n  } = _ref2;\n  try {\n    const res = await server.post(regURI, {\n      userName,\n      email,\n      phone,\n      password\n    });\n    if (res.data.token) {\n      window.localStorage.setItem('token', res.data.token);\n    }\n  } catch (e) {\n    console.log(`Registration failed: ${e}`);\n  }\n});\nexport const authSlice = createSlice({\n  name: 'auth',\n  initialState,\n  reducers: {},\n  extraReducers: {\n    [createUser.fulfilled]: (state, action) => {\n      state.isLoading = false;\n      state.status = action.payload.message;\n      state.user = action.payload.email;\n      state.token = action.payload.token;\n      console.log('Successfull registartion');\n    },\n    [createUser.pending]: state => {\n      state.isLoading = true;\n      state.status = null;\n      console.log('Creating user');\n    },\n    [createUser.rejected]: (state, action) => {\n      state.isLoading = false;\n      state.status = action.payload.message;\n      console.log(`Login rejected`);\n    }\n  }\n});\nexport const {\n  login,\n  registration\n} = authSlice.actions;\nexport default authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","server","logURI","regURI","initialState","newUser","userName","email","phone","password","token","isLoading","status","userLogin","user","LoginAttempt","res","get","data","window","localStorage","setItem","e","console","log","createUser","post","authSlice","name","reducers","extraReducers","fulfilled","state","action","payload","message","pending","rejected","login","registration","actions","reducer"],"sources":["C:/Users/forbi/Documents/Git/handover/WIP/Labour1/frontend/src/redux/features/auth/authSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\r\nimport server from '../../../utilites/connection';\r\n\r\nconst logURI = '/auth/login';\r\nconst regURI = '/auth/registration';\r\n\r\nconst initialState = {\r\n  newUser: {\r\n    userName: '',\r\n    email: '',\r\n    phone: '',\r\n    password: '',\r\n    token: null,\r\n    isLoading: false,\r\n    status: null,\r\n  },\r\n  userLogin: {\r\n    user: null,\r\n    token: null,\r\n    isLoading: false,\r\n    status: null,\r\n  },\r\n};\r\n\r\nexport const LoginAttempt = createAsyncThunk(\r\n  'auth/LoginAttempt',\r\n  async ({ email, password }) => {\r\n    try {\r\n      const res = await server.get(logURI, { email, password });\r\n      if (res.data.token) {\r\n        window.localStorage.setItem('token', res.data.token);\r\n      }\r\n      return res.data;\r\n    } catch (e) {\r\n      console.log(`Login failed: ${e}`);\r\n    }\r\n  }\r\n);\r\n\r\nexport const createUser = createAsyncThunk(\r\n  'auth/createUser',\r\n  async ({ userName, email, phone, password }) => {\r\n    try {\r\n      const res = await server.post(regURI, {\r\n        userName,\r\n        email,\r\n        phone,\r\n        password,\r\n      });\r\n      if (res.data.token) {\r\n        window.localStorage.setItem('token', res.data.token);\r\n      }\r\n    } catch (e) {\r\n      console.log(`Registration failed: ${e}`);\r\n    }\r\n  }\r\n);\r\n\r\nexport const authSlice = createSlice({\r\n  name: 'auth',\r\n  initialState,\r\n  reducers: {},\r\n  extraReducers: {\r\n    [createUser.fulfilled]: (state, action) => {\r\n      state.isLoading = false;\r\n      state.status = action.payload.message;\r\n      state.user = action.payload.email;\r\n      state.token = action.payload.token;\r\n      console.log('Successfull registartion');\r\n    },\r\n    [createUser.pending]: (state) => {\r\n      state.isLoading = true;\r\n      state.status = null;\r\n      console.log('Creating user');\r\n    },\r\n    [createUser.rejected]: (state, action) => {\r\n      state.isLoading = false;\r\n      state.status = action.payload.message;\r\n      console.log(`Login rejected`);\r\n    },\r\n  },\r\n});\r\n\r\nexport const { login, registration } = authSlice.actions;\r\nexport default authSlice.reducer;\r\n"],"mappings":"AAAA,SAASA,WAAW,EAAEC,gBAAgB,QAAQ,kBAAkB;AAChE,OAAOC,MAAM,MAAM,8BAA8B;AAEjD,MAAMC,MAAM,GAAG,aAAa;AAC5B,MAAMC,MAAM,GAAG,oBAAoB;AAEnC,MAAMC,YAAY,GAAG;EACnBC,OAAO,EAAE;IACPC,QAAQ,EAAE,EAAE;IACZC,KAAK,EAAE,EAAE;IACTC,KAAK,EAAE,EAAE;IACTC,QAAQ,EAAE,EAAE;IACZC,KAAK,EAAE,IAAI;IACXC,SAAS,EAAE,KAAK;IAChBC,MAAM,EAAE;EACV,CAAC;EACDC,SAAS,EAAE;IACTC,IAAI,EAAE,IAAI;IACVJ,KAAK,EAAE,IAAI;IACXC,SAAS,EAAE,KAAK;IAChBC,MAAM,EAAE;EACV;AACF,CAAC;AAED,OAAO,MAAMG,YAAY,GAAGf,gBAAgB,CAC1C,mBAAmB,EACnB,cAA+B;EAAA,IAAxB;IAAEO,KAAK;IAAEE;EAAS,CAAC;EACxB,IAAI;IACF,MAAMO,GAAG,GAAG,MAAMf,MAAM,CAACgB,GAAG,CAACf,MAAM,EAAE;MAAEK,KAAK;MAAEE;IAAS,CAAC,CAAC;IACzD,IAAIO,GAAG,CAACE,IAAI,CAACR,KAAK,EAAE;MAClBS,MAAM,CAACC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEL,GAAG,CAACE,IAAI,CAACR,KAAK,CAAC;IACtD;IACA,OAAOM,GAAG,CAACE,IAAI;EACjB,CAAC,CAAC,OAAOI,CAAC,EAAE;IACVC,OAAO,CAACC,GAAG,CAAE,iBAAgBF,CAAE,EAAC,CAAC;EACnC;AACF,CAAC,CACF;AAED,OAAO,MAAMG,UAAU,GAAGzB,gBAAgB,CACxC,iBAAiB,EACjB,eAAgD;EAAA,IAAzC;IAAEM,QAAQ;IAAEC,KAAK;IAAEC,KAAK;IAAEC;EAAS,CAAC;EACzC,IAAI;IACF,MAAMO,GAAG,GAAG,MAAMf,MAAM,CAACyB,IAAI,CAACvB,MAAM,EAAE;MACpCG,QAAQ;MACRC,KAAK;MACLC,KAAK;MACLC;IACF,CAAC,CAAC;IACF,IAAIO,GAAG,CAACE,IAAI,CAACR,KAAK,EAAE;MAClBS,MAAM,CAACC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEL,GAAG,CAACE,IAAI,CAACR,KAAK,CAAC;IACtD;EACF,CAAC,CAAC,OAAOY,CAAC,EAAE;IACVC,OAAO,CAACC,GAAG,CAAE,wBAAuBF,CAAE,EAAC,CAAC;EAC1C;AACF,CAAC,CACF;AAED,OAAO,MAAMK,SAAS,GAAG5B,WAAW,CAAC;EACnC6B,IAAI,EAAE,MAAM;EACZxB,YAAY;EACZyB,QAAQ,EAAE,CAAC,CAAC;EACZC,aAAa,EAAE;IACb,CAACL,UAAU,CAACM,SAAS,GAAG,CAACC,KAAK,EAAEC,MAAM,KAAK;MACzCD,KAAK,CAACrB,SAAS,GAAG,KAAK;MACvBqB,KAAK,CAACpB,MAAM,GAAGqB,MAAM,CAACC,OAAO,CAACC,OAAO;MACrCH,KAAK,CAAClB,IAAI,GAAGmB,MAAM,CAACC,OAAO,CAAC3B,KAAK;MACjCyB,KAAK,CAACtB,KAAK,GAAGuB,MAAM,CAACC,OAAO,CAACxB,KAAK;MAClCa,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAC;IACzC,CAAC;IACD,CAACC,UAAU,CAACW,OAAO,GAAIJ,KAAK,IAAK;MAC/BA,KAAK,CAACrB,SAAS,GAAG,IAAI;MACtBqB,KAAK,CAACpB,MAAM,GAAG,IAAI;MACnBW,OAAO,CAACC,GAAG,CAAC,eAAe,CAAC;IAC9B,CAAC;IACD,CAACC,UAAU,CAACY,QAAQ,GAAG,CAACL,KAAK,EAAEC,MAAM,KAAK;MACxCD,KAAK,CAACrB,SAAS,GAAG,KAAK;MACvBqB,KAAK,CAACpB,MAAM,GAAGqB,MAAM,CAACC,OAAO,CAACC,OAAO;MACrCZ,OAAO,CAACC,GAAG,CAAE,gBAAe,CAAC;IAC/B;EACF;AACF,CAAC,CAAC;AAEF,OAAO,MAAM;EAAEc,KAAK;EAAEC;AAAa,CAAC,GAAGZ,SAAS,CAACa,OAAO;AACxD,eAAeb,SAAS,CAACc,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}