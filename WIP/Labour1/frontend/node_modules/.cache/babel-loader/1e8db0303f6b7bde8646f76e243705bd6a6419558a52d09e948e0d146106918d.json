{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport server from '../../../utilites/connection';\nconst logURI = '/auth/login';\nconst regURI = '/auth/registration';\nconst initialState = {\n  newUser: {\n    userName: '',\n    email: '',\n    phone: '',\n    password: '',\n    token: null,\n    isLoading: false,\n    status: null\n  },\n  userLogin: {\n    data: null,\n    status: null\n  }\n};\nexport const LoginAttempt = createAsyncThunk('auth/LoginAttempt', async params => {\n  try {\n    const res = await server.post(logURI, params);\n    return res.data;\n  } catch (e) {\n    console.log(`Login failed: ${e}`);\n  }\n});\nexport const createUser = createAsyncThunk('auth/createUser', async _ref => {\n  let {\n    userName,\n    email,\n    phone,\n    password\n  } = _ref;\n  try {\n    const res = await server.post(regURI, {\n      userName,\n      email,\n      phone,\n      password\n    });\n    if (res.data.token) {\n      window.localStorage.setItem('token', res.data.token);\n    }\n  } catch (e) {\n    console.log(`Registration failed: ${e}`);\n  }\n});\nexport const authSlice = createSlice({\n  name: 'auth',\n  initialState,\n  reducers: {},\n  extraReducers: {\n    [createUser.fulfilled]: (state, action) => {\n      state.isLoading = false;\n      state.status = action.payload.message;\n      state.user = action.payload.email;\n      state.token = action.payload.token;\n      console.log('Successfull registartion');\n    },\n    [createUser.pending]: state => {\n      state.isLoading = true;\n      state.status = null;\n      console.log('Creating user');\n    },\n    [createUser.rejected]: (state, action) => {\n      state.isLoading = false;\n      state.status = action.payload.message;\n      console.log(`Login rejected`);\n    },\n    [LoginAttempt.pending]: state => {\n      state.userLogin.status = 'loading';\n      state.userLogin.data = null;\n    },\n    [LoginAttempt.fulfilled]: (state, action) => {\n      state.userLogin.status = 'complete';\n      state.userLogin.data = action.payload;\n    },\n    [LoginAttempt.rejected]: state => {\n      state.userLogin.status = 'error';\n      state.userLogin.data = null;\n    }\n  }\n});\n\n// checking if user = authorized\nexport function isAuthorized(state) {\n  console.log(state.auth.data);\n  return Boolean(state.auth.data);\n}\nexport default authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","server","logURI","regURI","initialState","newUser","userName","email","phone","password","token","isLoading","status","userLogin","data","LoginAttempt","params","res","post","e","console","log","createUser","window","localStorage","setItem","authSlice","name","reducers","extraReducers","fulfilled","state","action","payload","message","user","pending","rejected","isAuthorized","auth","Boolean","reducer"],"sources":["C:/Users/sobol/Documents/Git/handover/WIP/Labour1/frontend/src/redux/features/auth/authSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\r\nimport server from '../../../utilites/connection';\r\n\r\nconst logURI = '/auth/login';\r\nconst regURI = '/auth/registration';\r\n\r\nconst initialState = {\r\n  newUser: {\r\n    userName: '',\r\n    email: '',\r\n    phone: '',\r\n    password: '',\r\n    token: null,\r\n    isLoading: false,\r\n    status: null,\r\n  },\r\n  userLogin: {\r\n    data: null,\r\n    status: null,\r\n  },\r\n};\r\n\r\nexport const LoginAttempt = createAsyncThunk(\r\n  'auth/LoginAttempt',\r\n  async (params) => {\r\n    try {\r\n      const res = await server.post(logURI, params);\r\n      return res.data;\r\n    } catch (e) {\r\n      console.log(`Login failed: ${e}`);\r\n    }\r\n  }\r\n);\r\n\r\nexport const createUser = createAsyncThunk(\r\n  'auth/createUser',\r\n  async ({ userName, email, phone, password }) => {\r\n    try {\r\n      const res = await server.post(regURI, {\r\n        userName,\r\n        email,\r\n        phone,\r\n        password,\r\n      });\r\n      if (res.data.token) {\r\n        window.localStorage.setItem('token', res.data.token);\r\n      }\r\n    } catch (e) {\r\n      console.log(`Registration failed: ${e}`);\r\n    }\r\n  }\r\n);\r\n\r\nexport const authSlice = createSlice({\r\n  name: 'auth',\r\n  initialState,\r\n  reducers: {},\r\n  extraReducers: {\r\n    [createUser.fulfilled]: (state, action) => {\r\n      state.isLoading = false;\r\n      state.status = action.payload.message;\r\n      state.user = action.payload.email;\r\n      state.token = action.payload.token;\r\n      console.log('Successfull registartion');\r\n    },\r\n    [createUser.pending]: (state) => {\r\n      state.isLoading = true;\r\n      state.status = null;\r\n      console.log('Creating user');\r\n    },\r\n    [createUser.rejected]: (state, action) => {\r\n      state.isLoading = false;\r\n      state.status = action.payload.message;\r\n      console.log(`Login rejected`);\r\n    },\r\n    [LoginAttempt.pending]: (state) => {\r\n      state.userLogin.status = 'loading';\r\n      state.userLogin.data = null;\r\n    },\r\n    [LoginAttempt.fulfilled]: (state, action) => {\r\n      state.userLogin.status = 'complete';\r\n      state.userLogin.data = action.payload;\r\n    },\r\n    [LoginAttempt.rejected]: (state) => {\r\n      state.userLogin.status = 'error';\r\n      state.userLogin.data = null;\r\n    },\r\n  },\r\n});\r\n\r\n// checking if user = authorized\r\nexport function isAuthorized(state) {\r\n  console.log(state.auth.data);\r\n  return Boolean(state.auth.data);\r\n}\r\n\r\nexport default authSlice.reducer;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}