{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport instance from '../../../utilites/connection';\nconst logURI = '/auth/login';\nconst regURI = '/auth/registration';\nconst initialState = {\n  user: null,\n  token: null,\n  isLoading: false,\n  status: null\n};\nexport const LoginAttempt = createAsyncThunk('auth/LoginAttempt', async _ref => {\n  let {\n    email,\n    password\n  } = _ref;\n  try {\n    const res = await instance.get(logURI, {\n      email,\n      password\n    });\n    if (res.data.token) {\n      window.localStorage.setItem('token', res.data.token);\n    }\n    return res.data;\n  } catch (e) {\n    console.log(`Login failed: ${e}`);\n  }\n});\nexport const createUser = createAsyncThunk('auth/createUser', async _ref2 => {\n  let {\n    userName,\n    email,\n    phone,\n    password\n  } = _ref2;\n  try {\n    const res = await instance.post(regURI, {\n      userName,\n      email,\n      phone,\n      password\n    });\n    if (res.data.token) {\n      window.localStorage.setItem('token', res.data.token);\n    }\n  } catch (e) {\n    console.log(`Registration failed: ${e}`);\n  }\n});\nexport const authSlice = createSlice({\n  name: 'auth',\n  initialState,\n  reducers: {\n    login: (state, action) => {\n      state.islogin = action.payload;\n    },\n    registration: (state, action) => {\n      state.userParams = action.payload;\n    }\n  },\n  extraReducers: {\n    [createUser.fulfilled]: (state, action) => {\n      state.isLoading = false;\n      state.status = action.payload.message;\n      state.user = action.payload.email;\n      state.token = action.payload.token;\n      console.log('Successfull registartion');\n    },\n    [createUser.pending]: state => {\n      state.isLoading = true;\n      state.status = null;\n      console.log('Creating user');\n    },\n    [createUser.rejected]: (state, action) => {\n      state.isLoading = false;\n      state.status = action.payload.message;\n      console.log(`Login rejected`);\n    }\n  }\n});\nexport const {\n  login,\n  registration\n} = authSlice.actions;\nexport default authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","instance","logURI","regURI","initialState","user","token","isLoading","status","LoginAttempt","email","password","res","get","data","window","localStorage","setItem","e","console","log","createUser","userName","phone","post","authSlice","name","reducers","login","state","action","islogin","payload","registration","userParams","extraReducers","fulfilled","message","pending","rejected","actions","reducer"],"sources":["C:/Users/forbi/Documents/Git/handover/WIP/Labour1/frontend/src/redux/features/auth/authSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\r\nimport instance from '../../../utilites/connection';\r\n\r\nconst logURI = '/auth/login';\r\nconst regURI = '/auth/registration';\r\n\r\nconst initialState = {\r\n  user: null,\r\n  token: null,\r\n  isLoading: false,\r\n  status: null,\r\n};\r\n\r\nexport const LoginAttempt = createAsyncThunk(\r\n  'auth/LoginAttempt',\r\n  async ({ email, password }) => {\r\n    try {\r\n      const res = await instance.get(logURI, { email, password });\r\n      if (res.data.token) {\r\n        window.localStorage.setItem('token', res.data.token);\r\n      }\r\n      return res.data;\r\n    } catch (e) {\r\n      console.log(`Login failed: ${e}`);\r\n    }\r\n  }\r\n);\r\n\r\nexport const createUser = createAsyncThunk(\r\n  'auth/createUser',\r\n  async ({ userName, email, phone, password }) => {\r\n    try {\r\n      const res = await instance.post(regURI, {\r\n        userName,\r\n        email,\r\n        phone,\r\n        password,\r\n      });\r\n      if (res.data.token) {\r\n        window.localStorage.setItem('token', res.data.token);\r\n      }\r\n    } catch (e) {\r\n      console.log(`Registration failed: ${e}`);\r\n    }\r\n  }\r\n);\r\n\r\nexport const authSlice = createSlice({\r\n  name: 'auth',\r\n  initialState,\r\n  reducers: {\r\n    login: (state, action) => {\r\n      state.islogin = action.payload;\r\n    },\r\n    registration: (state, action) => {\r\n      state.userParams = action.payload;\r\n    },\r\n  },\r\n  extraReducers: {\r\n    [createUser.fulfilled]: (state, action) => {\r\n      state.isLoading = false;\r\n      state.status = action.payload.message;\r\n      state.user = action.payload.email;\r\n      state.token = action.payload.token;\r\n      console.log('Successfull registartion');\r\n    },\r\n    [createUser.pending]: (state) => {\r\n      state.isLoading = true;\r\n      state.status = null;\r\n      console.log('Creating user');\r\n    },\r\n    [createUser.rejected]: (state, action) => {\r\n      state.isLoading = false;\r\n      state.status = action.payload.message;\r\n      console.log(`Login rejected`);\r\n    },\r\n  },\r\n});\r\n\r\nexport const { login, registration } = authSlice.actions;\r\nexport default authSlice.reducer;\r\n"],"mappings":"AAAA,SAASA,WAAW,EAAEC,gBAAgB,QAAQ,kBAAkB;AAChE,OAAOC,QAAQ,MAAM,8BAA8B;AAEnD,MAAMC,MAAM,GAAG,aAAa;AAC5B,MAAMC,MAAM,GAAG,oBAAoB;AAEnC,MAAMC,YAAY,GAAG;EACnBC,IAAI,EAAE,IAAI;EACVC,KAAK,EAAE,IAAI;EACXC,SAAS,EAAE,KAAK;EAChBC,MAAM,EAAE;AACV,CAAC;AAED,OAAO,MAAMC,YAAY,GAAGT,gBAAgB,CAC1C,mBAAmB,EACnB,cAA+B;EAAA,IAAxB;IAAEU,KAAK;IAAEC;EAAS,CAAC;EACxB,IAAI;IACF,MAAMC,GAAG,GAAG,MAAMX,QAAQ,CAACY,GAAG,CAACX,MAAM,EAAE;MAAEQ,KAAK;MAAEC;IAAS,CAAC,CAAC;IAC3D,IAAIC,GAAG,CAACE,IAAI,CAACR,KAAK,EAAE;MAClBS,MAAM,CAACC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEL,GAAG,CAACE,IAAI,CAACR,KAAK,CAAC;IACtD;IACA,OAAOM,GAAG,CAACE,IAAI;EACjB,CAAC,CAAC,OAAOI,CAAC,EAAE;IACVC,OAAO,CAACC,GAAG,CAAE,iBAAgBF,CAAE,EAAC,CAAC;EACnC;AACF,CAAC,CACF;AAED,OAAO,MAAMG,UAAU,GAAGrB,gBAAgB,CACxC,iBAAiB,EACjB,eAAgD;EAAA,IAAzC;IAAEsB,QAAQ;IAAEZ,KAAK;IAAEa,KAAK;IAAEZ;EAAS,CAAC;EACzC,IAAI;IACF,MAAMC,GAAG,GAAG,MAAMX,QAAQ,CAACuB,IAAI,CAACrB,MAAM,EAAE;MACtCmB,QAAQ;MACRZ,KAAK;MACLa,KAAK;MACLZ;IACF,CAAC,CAAC;IACF,IAAIC,GAAG,CAACE,IAAI,CAACR,KAAK,EAAE;MAClBS,MAAM,CAACC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEL,GAAG,CAACE,IAAI,CAACR,KAAK,CAAC;IACtD;EACF,CAAC,CAAC,OAAOY,CAAC,EAAE;IACVC,OAAO,CAACC,GAAG,CAAE,wBAAuBF,CAAE,EAAC,CAAC;EAC1C;AACF,CAAC,CACF;AAED,OAAO,MAAMO,SAAS,GAAG1B,WAAW,CAAC;EACnC2B,IAAI,EAAE,MAAM;EACZtB,YAAY;EACZuB,QAAQ,EAAE;IACRC,KAAK,EAAE,CAACC,KAAK,EAAEC,MAAM,KAAK;MACxBD,KAAK,CAACE,OAAO,GAAGD,MAAM,CAACE,OAAO;IAChC,CAAC;IACDC,YAAY,EAAE,CAACJ,KAAK,EAAEC,MAAM,KAAK;MAC/BD,KAAK,CAACK,UAAU,GAAGJ,MAAM,CAACE,OAAO;IACnC;EACF,CAAC;EACDG,aAAa,EAAE;IACb,CAACd,UAAU,CAACe,SAAS,GAAG,CAACP,KAAK,EAAEC,MAAM,KAAK;MACzCD,KAAK,CAACtB,SAAS,GAAG,KAAK;MACvBsB,KAAK,CAACrB,MAAM,GAAGsB,MAAM,CAACE,OAAO,CAACK,OAAO;MACrCR,KAAK,CAACxB,IAAI,GAAGyB,MAAM,CAACE,OAAO,CAACtB,KAAK;MACjCmB,KAAK,CAACvB,KAAK,GAAGwB,MAAM,CAACE,OAAO,CAAC1B,KAAK;MAClCa,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAC;IACzC,CAAC;IACD,CAACC,UAAU,CAACiB,OAAO,GAAIT,KAAK,IAAK;MAC/BA,KAAK,CAACtB,SAAS,GAAG,IAAI;MACtBsB,KAAK,CAACrB,MAAM,GAAG,IAAI;MACnBW,OAAO,CAACC,GAAG,CAAC,eAAe,CAAC;IAC9B,CAAC;IACD,CAACC,UAAU,CAACkB,QAAQ,GAAG,CAACV,KAAK,EAAEC,MAAM,KAAK;MACxCD,KAAK,CAACtB,SAAS,GAAG,KAAK;MACvBsB,KAAK,CAACrB,MAAM,GAAGsB,MAAM,CAACE,OAAO,CAACK,OAAO;MACrClB,OAAO,CAACC,GAAG,CAAE,gBAAe,CAAC;IAC/B;EACF;AACF,CAAC,CAAC;AAEF,OAAO,MAAM;EAAEQ,KAAK;EAAEK;AAAa,CAAC,GAAGR,SAAS,CAACe,OAAO;AACxD,eAAef,SAAS,CAACgB,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}